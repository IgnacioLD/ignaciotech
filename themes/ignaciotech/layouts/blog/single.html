{{ define "main" }}
<article class="blog-post content-section">
  <div class="container">
    <header class="blog-header">
      <h1 class="blog-post-title">{{ .Title }}</h1>
      <div class="blog-post-meta">
        <time datetime="{{ .Date.Format "2006-01-02" }}">{{ .Date.Format "January 2, 2006" }}</time>
        {{ with .Params.categories }}
        <div class="blog-tags">
          {{ range . }}
          <a href="{{ "/categories/" | relLangURL }}{{ . | urlize }}/" class="blog-tag">{{ . }}</a>
          {{ end }}
        </div>
        {{ end }}
      </div>
    </header>
    
    {{ if and .Params.image (ne .Params.image "/images/placeholders/blog-edit.svg") }}
    <div class="blog-hero">
      {{ partial "image.html" (dict "page" . "src" .Params.image "alt" .Title "class" "blog-hero-image" "width" 1600) }}
    </div>
    {{ end }}
    
    <div class="blog-layout">
      <div class="blog-content">
        {{ .Content }}

        {{ with .Params.references }}
        <section class="references-section" id="references">
          <h2>References</h2>
          <ol class="references-list">
            {{ range . }}
              <li>
                {{- if .url -}}
                  <a href="{{ .url }}" rel="noopener noreferrer" target="_blank">{{ .title | default .url }}</a>
                {{- else -}}
                  {{ .title }}
                {{- end -}}
                {{ with .note }}<span class="reference-note"> — {{ . }}</span>{{ end }}
              </li>
            {{ end }}
          </ol>
        </section>
        {{ end }}
      </div>
      <aside class="blog-notes" aria-label="Author Notes">
        <div class="notes-card">
          <h3>Author Notes</h3>
          {{ $notes := .Params.author_notes }}
          {{ if $notes }}
            {{ if (reflect.IsSlice $notes) }}
              <ul class="notes-list">
                {{ range $notes }}
                  <li>{{ . | markdownify }}</li>
                {{ end }}
              </ul>
            {{ else }}
              <div class="notes-body">{{ $notes | markdownify }}</div>
            {{ end }}
          {{ else }}
            <p class="notes-note">No notes for this post.</p>
          {{ end }}
        </div>
      </aside>
    </div>
    
    {{ if .Params.tags }}
    <div class="blog-tags-section">
      <h3>Tags</h3>
      <div class="blog-tags">
        {{ range .Params.tags }}
        <a href="{{ "/tags/" | relLangURL }}{{ . | urlize }}/" class="blog-tag">{{ . }}</a>
        {{ end }}
      </div>
    </div>
    {{ end }}
    
    <footer class="blog-footer">
      <div class="share-buttons">
        <span class="share-label">Share:</span>
        <a class="share-button" href="https://twitter.com/intent/tweet?url={{ .Permalink }}&text={{ .Title | urlquery }}" target="_blank" rel="noopener noreferrer">X</a>
        <a class="share-button" href="https://www.linkedin.com/sharing/share-offsite/?url={{ .Permalink }}" target="_blank" rel="noopener noreferrer">LinkedIn</a>
        <a class="share-button" href="https://www.reddit.com/submit?url={{ .Permalink }}&title={{ .Title | urlquery }}" target="_blank" rel="noopener noreferrer">Reddit</a>
      </div>
      <div class="blog-navigation">
        {{ with .PrevInSection }}
        <a href="{{ .RelPermalink }}" class="blog-nav-link prev">
          <span>← Previous</span>
          <span>{{ .Title }}</span>
        </a>
        {{ end }}
        
        {{ with .NextInSection }}
        <a href="{{ .RelPermalink }}" class="blog-nav-link next">
          <span>Next →</span>
          <span>{{ .Title }}</span>
        </a>
        {{ end }}
      </div>
      
      <div class="blog-back">
        <a href="/blog/" class="cta-button">Back to Blog</a>
        <a href="/archives/" class="cta-button secondary">View Archives</a>
      </div>
    </footer>
  </div>
</article>
{{ end }}
