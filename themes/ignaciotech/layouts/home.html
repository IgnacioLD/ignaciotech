{{ define "main" }}
{{ $projects := site.Data.projects }}
{{ if eq site.Language.Lang "es" }}
  {{ $projects = site.Data.es.projects }}
{{ end }}

<!-- Hero Section -->
<section class="hero">
  <div class="hero-inner">
    <div class="hero-copy">
      <h1>Ignacio Loyola</h1>
      <p class="lead">Android / AI engineer based in Valencia, Spain. I write and build things around mobile, accessibility, and practical AI.</p>
      <p class="lead">My goal is to explore and share ideas and projects that make technology more useful, humane, and accessible.</p>
      <div class="explore">
        <strong>Explore</strong> ·
        <a href="/projects/">Projects</a>
        · <a href="/blog/">Blog</a>
        · <a href="/tags/">Archives</a>
      </div>
      <div class="connect">
        <strong>Connect</strong>
        <div class="icon-row">
          {{ with site.Params.social.linkedin }}
          <a class="icon-link" href="{{ . }}" aria-label="LinkedIn" target="_blank" rel="noopener noreferrer">
            <svg width="22" height="22" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true"><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zM7.119 20.452H3.555V9h3.564v11.452z"/></svg>
          </a>
          {{ end }}
          {{ with site.Params.social.email }}
          <a class="icon-link" href="mailto:{{ . }}" aria-label="Email">
            <svg width="22" height="22" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true"><path d="M20 4H4c-1.1 0-2 .9-2 2v12a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V6c0-1.1-.9-2-2-2Zm0 4-8 5-8-5V6l8 5 8-5v2Z"/></svg>
          </a>
          {{ end }}
          {{ with site.Params.social.mastodon }}
          <a class="icon-link" href="{{ . }}" aria-label="Mastodon" target="_blank" rel="me noopener noreferrer">
            <svg width="22" height="22" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true"><path d="M21.43 13.1c-.3 1.55-2.7 3.26-5.47 3.56-1.44.16-2.86.31-4.38.25-2.48-.11-4.44-.59-4.44-.59 0 .24.02.47.06.69.33 1.88 2.49 1.99 4.53 2.05 2.06.06 3.9-.51 3.9-.51l.08 1.74s-1.44.77-4.01.91c-1.42.08-3.18-.04-5.23-.58-4.45-1.17-5.23-5.86-5.23-10.66 0-4.79 3.14-6.2 3.14-6.2 1.58-.73 4.3-1.05 7.1-1.08h.07c2.8.03 5.52.36 7.1 1.08 0 0 3.14 1.41 3.14 6.2 0 .86-.11 1.87-.36 2.64ZM17.9 8.84c-.69 0-1.24.26-1.59.78l-.11.18-.11-.18c-.35-.52-.9-.78-1.59-.78-1.17 0-2.03.78-2.03 2.47v3.98h1.93v-3.83c0-.74.31-1.12.93-1.12.69 0 1.04.45 1.04 1.35v3.6h1.92v-3.6c0-.9.35-1.35 1.04-1.35.62 0 .93.38.93 1.12v3.83h1.94v-3.98c0-1.69-.86-2.47-2.03-2.47Z"/></svg>
          </a>
          {{ end }}
          {{ with site.Params.social.medium }}
          <a class="icon-link" href="{{ . }}" aria-label="Medium" target="_blank" rel="noopener noreferrer">
            <svg width="22" height="22" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true"><path d="M4 7.5c0-.3.1-.5.3-.7L7.2 3.1V3H1v.1l2.9 3.7c.2.2.3.5.3.7v8.7c0 .3-.1.5-.3.7L1 20.6V20h6.6v-.1l-2.9-3.7c-.2-.2-.3-.5-.3-.7V7.5Zm8.9 12.5c2.6 0 4.8-3.7 4.8-8.2S15.5 3.6 12.9 3.6s-4.8 3.7-4.8 8.2 2.2 8.2 4.8 8.2Zm8.5-1.1c.7 0 1.3-3.2 1.3-7.1s-.6-7.1-1.3-7.1c-.7 0-1.3 3.2-1.3 7.1s.6 7.1 1.3 7.1Z"/></svg>
          </a>
          {{ end }}
        </div>
      </div>
    </div>
    <div class="hero-side">
      {{ partial "image.html" (dict "page" . "src" "/portrait.jpg" "alt" "Ignacio Loyola" "class" "hero-side-img" "width" 1200 "loading" "lazy" "fetchpriority" "low") }}
    </div>
  </div>
</section>

<!-- Writing (featured and recent) -->
<section class="content-section">
  <div class="container">
    <h2 class="section-title">Writing</h2>
    {{ $blogPages := where .Site.RegularPages "Section" "blog" }}
    {{ $featured := where $blogPages "Params.featured" true }}
    {{ if gt (len $featured) 0 }}
    <div class="projects-section">
      <h3 class="projects-section-title">Featured</h3>
      <ul class="post-list">
        {{ range first 3 $featured }}
        <li class="post-item">
          <a href="{{ .RelPermalink }}">{{ .Title }}</a>
          <time datetime="{{ .Date.Format "2006-01-02" }}">{{ .Date.Format "Jan 2, 2006" }}</time>
        </li>
        {{ end }}
      </ul>
    </div>
    {{ end }}
    <div class="projects-section">
      <h3 class="projects-section-title">Recent</h3>
      <ul class="post-list">
        {{ $nonfeat := where $blogPages "Params.featured" "ne" true }}
        {{ range first 5 $nonfeat }}
        <li class="post-item">
          <a href="{{ .RelPermalink }}">{{ .Title }}</a>
          <time datetime="{{ .Date.Format "2006-01-02" }}">{{ .Date.Format "Jan 2, 2006" }}</time>
        </li>
        {{ end }}
      </ul>
    </div>
  </div>
</section>


<!-- Projects Section -->
<section id="projects" class="content-section">
  <div class="container">
    <h2 class="section-title">{{ i18n "projects.title" }}</h2>
    <p class="section-subtitle">{{ i18n "projects.subtitle" }}</p>
    
    <div class="card-grid">
      {{ range $projects.projects }}
      {{ $p1 := site.GetPage (print "/projects/" .slug "/") }}
      {{ $p2 := site.GetPage (print "projects/" .slug) }}
      {{ $page := or $p1 $p2 }}
      <div class="card" {{ if $page }}data-href="{{ $page.RelPermalink }}" role="link" tabindex="0"{{ end }}>
        {{ if $page }}
        <a href="{{ $page.RelPermalink }}" class="card-preview-link" aria-label="Open {{ .name }}">
          <div class="project-image-placeholder">
            {{ if .image }}
              {{ partial "image.html" (dict "page" $page "src" .image "alt" .name "class" "project-preview-image" "width" 1200) }}
            {{ else }}
              <img src="/images/placeholders/project-apps.svg" alt="{{ .name }}" class="project-preview-image">
            {{ end }}
          </div>
        </a>
        <h3><a href="{{ $page.RelPermalink }}">{{ .name }}</a></h3>
        {{ else }}
        <div class="project-image-placeholder">
          {{ if .image }}
            {{ partial "image.html" (dict "page" . "src" .image "alt" .name "class" "project-preview-image" "width" 1200) }}
          {{ else }}
            <img src="/images/placeholders/project-apps.svg" alt="{{ .name }}" class="project-preview-image">
          {{ end }}
        </div>
        <h3>{{ .name }}</h3>
        {{ end }}
        <p>{{ .description }}</p>
        <div class="skills-list">
          {{ range .skills }}
          <span class="skill-tag">{{ . }}</span>
          {{ end }}
        </div>
        
        {{ if .links }}
        <div class="project-links">
          {{ range .links }}
          <a href="{{ .url }}" target="_blank" rel="noopener noreferrer" class="project-link">
            <span>{{ .name }}</span>
            <span class="link-icon">↗</span>
          </a>
          {{ end }}
        </div>
        {{ end }}
      </div>
      {{ end }}
    </div>
  </div>
</section>


{{ end }}
